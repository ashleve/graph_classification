# @package _global_

# to execute this experiment run:
# python train.py logger=wandb +experiment/GAT_benchmarks=proteins

defaults:
    - override /trainer: default_trainer.yaml
    - override /model: null
    - override /datamodule: null
    - override /seeds: null
    - override /callbacks: wandb_callbacks.yaml
    - override /logger: wandb

seeds:
    pytorch_seed: 12345
    k_fold_split_seed: 12345

trainer:
    min_epochs: 10
    max_epochs: 100
    accumulate_grad_batches: 1
    gradient_clip_val: 0.5

model:
    _target_: src.models.graph_classifier.GraphClassifier
    architecture: GAT
    optimizer: adam
    lr: 0.001
    weight_decay: 0.00005
    node_features: ${datamodule.node_features}
    classes: ${datamodule.classes}
    conv1_size: 32
    conv2_size: 64
    conv3_size: 128
    pool_method: max
    lin1_size: 64
    dropout1: 0.25

datamodule:
    _target_: src.datamodules.proteins.ProteinsDataModule
    data_dir: ${data_dir}
    fold: ???
    num_splits: 10
    split_seed: ${seeds.k_fold_split_seed}
    batch_size: 32
    node_features: 4
    classes: 2

logger:
    wandb:
        tags: ["proteins"]
        notes: ""
        group: ""
